from vmauto import VMwareAuto
import time

vm = VMwareAuto("C:\\Lab1OSP\\New group\\Windows_10_Auto.vmx")
if not vm.check():
    print "Failed to initialize VMware or find machine!"
    exit(1)

print "Starting VM..."
vm.start(nsecwait=30)
print "Reverting to snapshot..."
vm.revert("CleanState")
print "Executing malware..."
vm.winexec("user", "password123", ["C:\\Malware\\sample_malware.exe"])
time.sleep(10)
print "Stopping VM..."
vm.stop()